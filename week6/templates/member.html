<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <meta charset="UTF-8">
        <title>登入成功</title>
        <link rel="stylesheet" href="/static/style.css">
    </head>
    <body>
        <div class="container">
            <div class="member-container">
                <div class="header">歡迎光臨，這是會員頁</div>
                <div style="padding: 20px; text-align: center;">
                    <div>{{ member_name }}，歡迎登入系統</div> <!--{{ member_name }} 可套入會員名稱-->
                    <a href="/logout" 
                        style="display:inline-block;
                        margin-top:20px;
                        padding:8px 16px;
                        background-color: #2b4b80;
                        color: white;
                        text-decoration: none;
                        border-radius: 4px;">登出系統</a>
                </div>
                <div class="section-divider"></div>

                <!--留言系統區域-->
                <div class="message">
                    <div class="form-title">快來留言吧</div>
                    <form id="message-form" method="post" action="/createMessage">
                        <div class="form-group">
                            <label for="content">內容</label>
                            <input type="text" id="content" name="content" style="width:60%;" required /> 
                        </div>
                        <div class="form-group button-group">
                            <button type="submit">送出</button>
                        </div>
                    </form>
                    <div class="section-divider" style="margin-top: 20px; margin-bottom: 20px;"></div>

                    <!--{% for 變數 in 列表 %} 迴圈渲染：Jinja2 模板引擎會將後端傳來的 messages 列表裡的資料，自動「複製貼上」幾次 HTML-->
                    {% for message in messages %} 
                        <div class="message-item">
                            <span style="font-weight: bold;">{{ message.member_name }}:</span> 
                            <span style="flex-grow: 1; margin-left: 5px;">{{ message.content }}</span>

                            <!--{% if ... %} 條件判斷：每一則留言在後端都標記了一個 is_my_message，True=X/False則無顯示X-->
                            {% if message.is_my_message %}
                                <!--onsubmit：事件監聽器「當使用者按下X按鈕時，準備要傳給後端前，請先執行這段程式碼」-->
                                <!--return confirmDelete();「執行 confirmDelete 這個函式，將結果（True 或 False）回報」-->
                                <form method="post" 
                                    action="/deleteMessage" 
                                    onsubmit="return confirmDelete();" 
                                    style="margin-left: 10px;padding: 0; align-self: center;">
                                        <!--<input type="hidden"> 隱藏欄位：當 {% for %} 迴圈在跑，會把每則留言的ID編號 ({{ message.id }}) 標記進 value 裡面-->
                                        <input type="hidden" name="message_id" value="{{ message.id }}">
                                        <button type="submit" 
                                            style="padding: 1px 6px; background-color: #d9534f;">X</button>
                                </form>
                            <!--{%if%} 迴圈結束-->
                            {% endif %}
                        </div>
                    <!--{%for in%} 迴圈結束-->
                    {% endfor %}
                </div>
            </div>
        </div>
    <script>
        function confirmDelete() {
            // 使用內建的 confirm 函式來確認刪除動作
            return confirm("確定要刪除這則留言嗎？");
        }
    </script>
    </body>
</html>